#include "mos6502.h"
#include "Bus.h"
#include <array>
#include <cstdint>
#include <iostream>


const std::array<Opcode, 0xff> mos6502::opcode_lookup = [] {
    std::array<Opcode, 0xff> table{}; 
    {% for opcode in opcodes %}
    table[{{opcode.opcode}}] = Opcode(
        "{{opcode.mnemonic}}",
        Opcode::AddrMode::{{opcode.address_mode}}, 
        &cpu::{{opcode.address_mode}},
        &cpu::{{opcode.mnemonic}},
        uint8_t({{opcode.cycles_needed}}),
        {% if opcode.extra_cycle -%}
        true
        {%- else -%}
        false
        {%- endif %}
    );
    {% endfor %}
    return table;
}();